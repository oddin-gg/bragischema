syntax = "proto3";

package bragi.historical_statistics;

option go_package = "oddin.gg/bragi";
option java_package = "com.oddin.bragi.historical_statistics";

import "bragi/csgo_common.proto";
import "bragi/common.proto";


message CsgoTeamStatistics {
  Team team = 2;
  repeated CsgoPlayerStatistics player_statistics = 3;
  CsgoMapVote map_vote = 4;
  repeated CsgoMapStatistics map_winrate = 5;
  repeated CsgoMapStatisticsAccordingSide round_winrate = 6;
  StatisticsValues overall_map_winrate = 7;
  CsgoStatisticsSideValues overall_round_winrate = 8;
  CsgoStatisticsSideValues pistol_winrate = 9;
  CsgoStatisticsSideValues pistol_win_conversion = 10;
  CsgoStatisticsSideValues pistol_loss_conversion = 11;
  CsgoStatisticsSideValues kills = 12;
  CsgoStatisticsSideValues deaths = 13;
  CsgoStatisticsSideValues kills_over_deaths = 14;
  CsgoStatisticsSideValues assists = 15;
  CsgoStatisticsSideValues flash_assists = 16;
  CsgoStatisticsSideValues damage = 17;
  CsgoStatisticsSideValues headshot_rate = 18;
  CsgoStatisticsSideValues opening_kills = 19;
  CsgoStatisticsSideValues opening_conversion = 20;
  CsgoStatisticsSideValues opening_death_conversion = 21;
  CsgoStatisticsSideValues awp_kills = 22;
  CsgoStatisticsSideValues elimination_winrate = 23;
  CsgoStatisticsSideValues objective_winrate = 24;
  CsgoStatisticsSideValues utility_damage = 25;
  CsgoStatisticsSideValues first_to_win_3_rounds = 26;
  CsgoStatisticsSideValues first_to_win_6_rounds = 27;
  CsgoStatisticsSideValues first_to_win_9_rounds = 28;
  CsgoStatisticsSideValues first_to_win_12_rounds = 29;
  CsgoStatisticsSideValues rounds_lost = 30;
  repeated CsgoWeaponStatistics favourite_weapons = 31;
  repeated Match form = 32;
}

message CsgoPlayerStatistics {
  Player player = 1;
  StatisticsValues kills = 2;
  StatisticsValues deaths = 3;
  StatisticsValues assists = 4;
  StatisticsValues kills_over_deaths = 5;
  StatisticsValues damage = 6;
  StatisticsValues headshot_rate = 7;
  StatisticsValues flash_assists = 8;
  StatisticsValues opening_kills = 9;
  StatisticsValues awp_kills = 10;
  StatisticsValues utility_damage = 11;
  StatisticsValues enemies_flashed = 12;
  StatisticsValues multi_kill_rounds = 13;
  StatisticsValues clutch_rounds = 14;
  StatisticsValues lurk_kills = 15;
  StatisticsValues grenades_used = 16;
  repeated CsgoWeaponStatistics favourite_weapons = 17;
}

message CsgoPostMapStatistics {
  CsgoMap map = 1;
  CsgoTeamPostMapStatistics home_team_statistics = 2;
  CsgoTeamPostMapStatistics away_team_statistics = 3;
  repeated CsgoPlayersDuel duels = 4;
  repeated CsgoRoundPostmap rounds = 5;
}

message CsgoTournamentInfo {
  uint32 id = 1;
  Tournament tournament = 2;
  optional string organizer = 3;
  optional string location = 4;
  optional string prize_pool = 5;
  optional bool is_offline = 6;
  optional bool is_qualification = 7;
  repeated CsgoTeam teams = 8;
  repeated Match matches = 9;
  repeated CsgoTournamentBlock blocks = 10;
}

message CsgoTournamentStatistics {
  uint32 id = 1;
  Tournament tournament = 2;
  optional float terrorists_winrate_in_percent = 3;
  optional float counter_terrorists_winrate_in_percent = 4;
  CsgoTournamentBestTeamStatistics best_teams = 5;
  CsgoTournamentBestPlayerStatistics best_players = 6;
  repeated CsgoTournamentMapStatistics tournament_maps_statistics = 7;
}

message CsgoTeamPostMapStatistics {
  uint32 id = 1;
  Team team = 2;
  repeated CsgoPlayerPostMapStatistics players_statistics = 3;
  int32 rounds_won = 4;
  int32 rounds_lost = 5;
  PostMapStatisticsValues kills = 6;
  PostMapStatisticsValues deaths = 7;
  PostMapStatisticsValues assists = 8;
  PostMapStatisticsValues kills_over_deaths = 9;
  PostMapStatisticsValues damage = 10;
  PostMapStatisticsValues headshot_rate = 11;
  PostMapStatisticsValues flash_assists = 12;
  PostMapStatisticsValues opening_kills = 13;
  PostMapStatisticsValues kills_difference = 14;
  PostMapStatisticsValues kill_cost = 15;
  PostMapStatisticsValues accuracy_rate = 16;
  PostMapStatisticsValues kills_with_dropped_weapons = 17;
  repeated CsgoWeaponPostMapStatistics favourite_weapons = 18;
}

message CsgoPlayerPostMapStatistics {
  uint32 id = 1;
  Player player = 2;
  CsgoPlayerRole player_map_role = 3;
  PostMapStatisticsValues kills = 4;
  PostMapStatisticsValues deaths = 5;
  PostMapStatisticsValues assists = 6;
  PostMapStatisticsValues rounds_survived = 7;
  PostMapStatisticsValues kills_over_deaths = 8;
  PostMapStatisticsValues damage = 9;
  PostMapStatisticsValues headshot_rate = 10;
  PostMapStatisticsValues flash_assists = 11;
  PostMapStatisticsValues opening_kills = 12;
  PostMapStatisticsValues clutch_rounds = 13;
  PostMapStatisticsValues utility_damage = 14;
  PostMapStatisticsValues grenades_used = 15;
  PostMapStatisticsValues enemies_flashed = 16;
  PostMapStatisticsValues awp_kills = 17;
  PostMapStatisticsValues lurk_kills = 18;
  PostMapStatisticsValues kills_difference = 19;
  PostMapStatisticsValues kill_cost = 20;
  PostMapStatisticsValues accuracy_rate = 21;
  repeated CsgoWeaponPostMapStatistics favourite_weapons = 22;
}

// ----------------------------------------------------------------------------------------------------------------------
// Csgo statistics entities ---------------------------------------------------------------------------------------------
// ----------------------------------------------------------------------------------------------------------------------

message CsgoRoundPostmap{
  int32 round = 1;
  Map map = 2;
  CsgoMap csgo_map = 3;
  Team winner_team = 4;
  CsgoSide winner_side = 5;
  CsgoWinReason win_reason = 6;
}

message CsgoMapStatisticsAccordingSide {
  CsgoMap map = 1;
  CsgoStatisticsSideValues statistics = 2;
}

message CsgoTournamentMapStatistics {
  CsgoMap map = 1;
  int32 picks = 2;
  int32 bans = 3;
  optional float terrorists_winrate_in_percent = 4;
  optional float counter_terrorists_winrate_in_percent = 5;
  CsgoTournamentBestTeamStatistics best_teams = 6;
  CsgoTournamentBestPlayerStatistics best_players = 7;
}

message CsgoTournamentPlayerStatistics {
  Player player = 1;
  optional Team team = 2;
  float value = 3;
}

message CsgoTournamentBestTeamStatistics {
  TournamentTeamStatisticsValue highest_kills = 1;
  TournamentTeamStatisticsValue highest_kills_over_deaths = 2;
  TournamentTeamStatisticsValue highest_awp_kills = 3;
  TournamentTeamStatisticsValueInPercent highest_plant_rate = 4;
  TournamentTeamStatisticsValueInPercent highest_defuse_rate = 5;
}

message CsgoTournamentBestPlayerStatistics {
  CsgoTournamentPlayerStatistics highest_kills = 1;
  CsgoTournamentPlayerStatistics highest_kills_over_deaths = 2;
  CsgoTournamentPlayerStatistics highest_damage = 3;
  CsgoTournamentPlayerStatistics highest_flash_assists = 4;
  CsgoTournamentPlayerStatistics highest_utility_damage = 5;
  CsgoTournamentPlayerStatistics highest_opening_kills = 6;
}

message CsgoTeamStandingRound {
  int32 round = 1;
  optional int32 team_score = 2;
  optional Team opponent = 3;
  optional int32 opponent_score = 4;
  bool match_is_closed = 5;
}

message CsgoPlayersDuel {
  CsgoPlayer home_player = 1;
  int32 home_player_kills = 2;
  CsgoPlayer away_player = 3;
  int32 away_player_kills = 4;
}

message CsgoStatisticsSideValues {
  StatisticsValues terrorists = 1;
  StatisticsValues counter_terrorists = 2;
  StatisticsValues all = 3;
}

message CsgoWeaponStatistics {
  CsgoWeapon weapon = 1;
  StatisticsValues kills_with_weapon = 2;
  StatisticsValues headshots_with_weapon = 3;
}

message CsgoWeaponPostMapStatistics {
  CsgoWeapon weapon = 1;
  int32 kills_with_weapon = 2;
  int32 headshots_with_weapon = 3;
}

message CsgoMap {
  uint32 id = 1;
  string name = 2;
  optional string icon_path = 3;
}

message CsgoMapVote {
  repeated CsgoMapStatistics picked = 1;
  repeated CsgoMapStatistics banned = 2;
}

message CsgoMapStatistics {
  CsgoMap map = 1;
  StatisticsValues statistics = 2;
}

message CsgoWeapon {
  uint32 id = 1;
  string name = 2;
  optional string icon_path = 3;
}

message CsgoTeam {
  uint32 id = 1;
  Team team = 2;
  repeated Player players = 3;
}

message CsgoPlayer {
  uint32 id = 1;
  string nickname = 2;
  optional string real_name = 3;
  optional string shortcut = 4;
  optional string icon_path = 5;
  CsgoPlayerRole role = 6;
}

message CsgoTournamentBlock {
  oneof oneof_name {
    CsgoTournamentStandingsBlock csgo_tournament_standings_block = 1;
    CsgoTournamentBracketsBlock csgo_tournament_brackets_block = 2;
  }
}

message CsgoTournamentStandingsBlock {
  uint32 id = 1;
  string name = 2;
  int32 order = 3;
  repeated CsgoTeamStanding standings = 4;
}

message CsgoTournamentBracketsBlock {
  uint32 id = 1;
  string name = 2;
  int32 order = 3;
  repeated TournamentBracketNode brackets = 4;
}

message CsgoTeamStanding {
  uint32 id = 1;
  int32 rank = 2;
  Team team = 3;
  int32 points = 4;
  int32 matches_won = 5;
  int32 matches_lost = 6;
  int32 matches_drawn = 7;
  int32 maps_won = 8;
  int32 maps_lost = 9;
  int32 maps_drawn = 10;
  int32 rounds_won = 11;
  int32 rounds_lost = 12;
  int32 map_difference = 13;
  int32 round_difference = 14;
  optional string status = 15;
  repeated CsgoTeamStandingRound rounds = 16;
}

message TournamentBracketNode {
  uint32 id = 1;
  optional Team home_team = 2;
  optional int32 home_score = 3;
  optional Team away_team = 4;
  optional int32 away_score = 5;
  optional Match match = 6;
  optional string label = 7;
  bool is_root = 8;
  repeated uint32 child_nodes = 9;
}

// ----------------------------------------------------------------------------------------------------------------------
// common entities ------------------------------------------------------------------------------------------------------
// ----------------------------------------------------------------------------------------------------------------------

message TournamentTeamStatisticsValue {
  Team team = 1;
  float value = 2;
}

message TournamentTeamStatisticsValueInPercent {
  Team team = 1;
  float value = 2; // In value in percent
}

message PostMapStatisticsValues {
  float percentage_of_maximum = 1;
  float total = 2;
}

message StatisticsValues {
  float avg = 1;
  float percentile = 2;
  float total = 3;
}

enum Timeframe {
  TIMEFRAME_UNSPECIFIED = 0;
  TIMEFRAME_ONE_MONTH = 1;
  TIMEFRAME_THREE_MONTHS = 2;
  TIMEFRAME_SIX_MONTHS = 3;
  TIMEFRAME_ONE_YEAR = 4;
}